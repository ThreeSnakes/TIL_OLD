# 2021_03_22

## Image CDN이란?

CDN은 (Content Delivery Network)의 약자로, 접속자가 인터넷상에서 가장 가까운 곳의 서버로부터 컨텐츠를 전송받도록 하여 특정 서버에 집중되지 않고, 각 서버로 분상되도록 하는 기술이다.

결국 광고의 썸네일을 최종 사용자(매체 접속자)가 가장 가까운 곳의 서버를 이용하여 빠르게 다운로드하여 화면에 렌더링을 하기 위한 목적이다.

Image에 CDN을 사용하는 이유는 크게 다음과 같다.
- 속도 향상
- 웹 성능 향상
- 비용 절감

그냥 CDN과 Image CDN의 차이를 이해하는게 좋다.
현재 쓰고 있는 아카마이는 그냥 CDN이라고 볼 수 있다. image CDN은 이미지에 최적화된 CDN 서비스라고 할 수 있다. 썸네일 서버가 일종의 Image CDN이라고 볼 수 있다.

## JPG의 Compression Level, HTTP 응답 크기 줄이기 (이미지 크기 최소화)

JPG란 Joint Phtographic Expert Group 이라는 단체에서 이미지 압축 표준으로 정한 포맷

무손실(Loseless) 압축은 X-레이나 CT사진에서와 같이 픽셀 하나하나가 중요한 경우에 사용됩니다.  
 
압축을 위해서 크게 6가지의 기술이 사용된다.
1. 색공간 변경(RGB to YCBCr)
	
	색의 3원소를 R(Red), G(Green), B(Blue)라 하는데, 일반적으로 픽셀
	을 각각의 RGB값을 0~255혼합하여 색을 만든다.
	
	그런데 이를 YCbCr이라는 조합으로 변경하는 것이다. Y는 픽셀의 밝기, Cb, Cr은 각각 색차 성분을 말한다.
2. 다운샘플링

	사람의 눈은 색상 성분보다 밝기(휘도) 성분에 더 민감하기 때문에 Y성분은 그래도 나두고 Cb, Cr을 줄여서 압축하는 전략이다.
	
3. DCT

	이미지를 8X8 블락으로 나눈이후, DCT를 적용하면 이미지를 주파수 관점에서 볼수 있게 된다. 여기서 고주파 성분을 줄여서 이미지의 용량을 줄이는 방법이다.
4. 양자화

	DCT가 고주파 성분을 줄이는 것이라면 양자화는 이미지의 고주파 성분을 제거하기 위한 방법이다. 주파수를 특정 상수로 나눈 이후 반올림 철하는 것이다. 즉 차이가 많이 나는 주파수를 특정 상수로 나눠서 줄이는 것이다.
	
5. Zig-zag 스캔

	2차원 배열에 담겨져 잇는 양자화된 계수를 지그재그 순서로 읽어서 1차원 벡터가 되게 만드는 것이다.

6. Entropy coding

	허프만 인코딩을 이용하셔 양자화된 계수들을 인코딩 하는 형태이다.

product 경험상 70% 정도가 원본과 품질차이가 적으면서도 사이즈를 줄일 수 있다고 한다.

## `<picture>` element, srcset과의 차이점

0개 이상의 `<source>`요소와 한개 이상의 `<img>` 요소를 갖는다 엘리먼트이다.

브라우저는 해당 엘리먼트를 만나면 `<source>` 요소중 일치하는 한개의 요소를 선택하지만, 만약 일치하는 항목이 없거나 브라우저가 해당 엘리먼트를 지원하지 않을 경우 `<img>` 엘리먼트를 노출하는 형태가 된다.

`<img>` 엘리먼트의 `srcset`의 경우에는 `해상도 전환용`이라 볼수 있고, `<picture>`의 경우에는 특정 화면에서 어떤 이미지를 보여줄 것인지를 결정하는 용도라 볼수 있다.

결국 `<img>` 엘리먼트의 `srcset`은 동일한 이미지의 해상도만 다른 이미지를 표시하는 용도이고, `<picture>`의 경우에는 서로 다른 이미지를 표시하기 위한 용도이다.

## HTTP 응답 크기 줄이기 (CSS)

- 중복코드나 사용하지 않는 코드를 없애서 css 파일 자체 사이즈를 줄인다.
	- Mififiter를 사용하면 공백을 제거하거나 약어를 사용함으로서 파일 사이즈 자체를 줄일 수 있다.
- 여러개의 CSS파일 보다는 하나의 파일로 합친다.

## HTTP 응답 크기 줄이기 (JS)

- 중복코드나 사용하지 않는 코드를 없애서 jS 파일 자체 사이즈를 줄인다.
	- minify, ugliyfi등을 이용해서 할수 있다.
- 코드 분할
- gzip