# 테스트 주도 개발

 ## 테스트 주도 개발
 
 몇가지 단계로 이루어진 반복적인 프로세스
 
 레드 -> 그린 -> 리팩터
 
- 레드(테스트 실패)
	 - 실패하는 테스트 추가
	 - 구체적인 하나의 요구사항을 검증하는 하나의 테스트를 추가
	 - 추가된 테스트가 실패하는지 확인
		 - 실패하는 것을 반드시 확인해야 한다.
		 - 운영 코드 변경이 진행되지 않았기 때문에 실패했는지 확인해야 한다.
	 - 테스트 코드 자체를 잘못 작성해서 실패하는 경우도 있다. 그래서 왜 실패했는지 확인해야 한다.

- 그린
	- 테스트 통과
	- 테스트 성공을 위한 최소한의 코딩
	- 새로 작성된 코드 테스트와 기존 코드 테스트를 통과시켜야 하는 코드 작성
	- 테스트 성공은 요구사항 만족을 의미한다.
	- 테스트 되지 않은 코드를 넣으면 안된다. 부작용이 생길수 있다. 테스트를 통과하는 최소한의 코드만 작성해야 한다.

- 리팩터
	- 코드베이스 정리
	- 구현 설계 개선
		- 구현부를 고치는 것이지 인터페이스를 변경하는게 아니다. 
		- 가독성, 적응성, 성능을 고려해야 한다.
	- 모든 테스트 통과 유지

TDD는 굉장히 지루한 작업이다. TDD는 불안함을 지루함으로 바꾸는 작업이다.

- 켄트백의 설계 규칙
	1. 테스트를 통과해야 한다.
	2. 코드가 어떤일을 하는지 의도를 노출시켜야 한다.
	3. 중복을 제거해야 한다.
		- 2번 항목과 3번 항목의 서로 상충하는 경우도 있다. 우선순위는 같은 선상에서 본다.
	4. 가장 적은 요소
		- 앞선 우선순위에 있는 규칙의 코드만 유지해야 한다.

## TDD의 세부 흐름

1. 단위 테스트 작성
2. 단위 테스트 실행
	1. 성공하는 경우
		1. 테스트를 잘못 작성한것이다.. 테스트가 잘못 작성한것인지 의심해봐라
	2. 실패하는 경우 
3. 운영코드 작성
	1. 다음 단계로 넘어간다.
4. 단위테스트 실행
	1. 성공
		1. 리팩토링 단계로 넘어간다.
	2. 실패
		1. 운영코드를 다시 수정한다.
5. 설계 개선

이러한 흐름은 일반적인 버그 제보 -> 재현 -> 개선과 닮았다. 단위 테스트를 작성하는 것 말고는 크게 다른게 없다.

## 테스트 주도 개발의 비용

TDD를 사용하지 않으면 비용은 점점 증가한다.
TDD를 사용하는 경우 초기 비용은 비싸지만 시간이 지나도 비용은 일정 수준으로 유지된다.
어느 시점이 되면 TDD를 사용하는 경우가 TDD를 사용하지 않는 경우보다 비용이 절감된다.
TDD를 사용할지 안할지는 프로젝트의 수명을 고려해서 사용하는게 좋다.
수명이 짧은 프로젝트에 TDD를 사용하는 것은 많은 비용을 사용하게 되는 것이다.
t2 지점을 지나간 이후부터 TDD를 사용하는데 비용이 적게 드는 것이다.

![TDD 비용그래프](attach/스크린샷%202021-04-21%20오전%207.26.46.png)

TDD를 사용할때 드는 비용을 줄이는 것도 좋은 방법중 하나이다.
  - TDD 역량을 늘리거나.
  - TDD를 쉽게 사용할 수 있는 도움을 받는 경우.

![TDD를 사용할때 드는 비용을 줄이는 경우](attach/스크린샷%202021-04-21%20오전%207.29.09.png)

위 이미지처럼 T2의 시점을 앞으로 땡길수 있게 되는 것이다.